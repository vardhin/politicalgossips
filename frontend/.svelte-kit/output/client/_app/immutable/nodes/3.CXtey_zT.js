import{c as Ie,a as x,t as q}from"../chunks/D7uXA1Ur.js";import{i as Pe}from"../chunks/BUZb4uKt.js";import{a5 as de,a6 as Ae,m as qe,l as De,q as Le,$ as Fe,y as t,z as _,o as e,v as r,x as v,A as l,t as P,a7 as Ce,B as Ge}from"../chunks/C6NBa0eJ.js";import{l as Oe,h as Te,r as oe,s as G,e as X}from"../chunks/Bh918-OH.js";import{i as O}from"../chunks/BHvfjOCM.js";import{r as ne,P as $e,a as Be}from"../chunks/BGlFHzz6.js";import{b as Y,a as Ue}from"../chunks/Bn_oBZ8q.js";import{o as Ee}from"../chunks/HOlLVa_p.js";import{g as Z}from"../chunks/eGLDC6Tn.js";function ue(a,m,n){if(a.multiple)return ze(a,m);for(var d of a.options){var u=A(d);if(Ae(u,m)){d.selected=!0;return}}(!n||m!==void 0)&&(a.selectedIndex=-1)}function Me(a,m){de(()=>{var n=new MutationObserver(()=>{var d=a.__value;ue(a,d)});return n.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{n.disconnect()}})}function Re(a,m,n=m){var d=!0;Oe(a,"change",u=>{var c=u?"[selected]":":checked",b;if(a.multiple)b=[].map.call(a.querySelectorAll(c),A);else{var k=a.querySelector(c)??a.querySelector("option:not([disabled])");b=k&&A(k)}n(b)}),de(()=>{var u=m();if(ue(a,u,d),d&&u===void 0){var c=a.querySelector(":checked");c!==null&&(u=A(c),n(u))}a.__value=u,d=!1}),Me(a)}function ze(a,m){for(var n of a.options)n.selected=~m.indexOf(A(n))}function A(a){return"__value"in a?a.__value:a.value}var Ne=q('<div class="loading-container svelte-kv1s9f"><div class="loading-spinner svelte-kv1s9f"></div> <p class="svelte-kv1s9f">Loading...</p></div>'),je=q('<div class="error-message svelte-kv1s9f"><p class="svelte-kv1s9f"> </p></div>'),Je=q('<div class="success-message svelte-kv1s9f"><p class="svelte-kv1s9f"> </p></div>'),We=q('<div class="image-preview svelte-kv1s9f"><img alt="Preview" class="svelte-kv1s9f"></div>'),He=q('<div class="dashboard-container svelte-kv1s9f"><header class="admin-header glass-panel svelte-kv1s9f"><h1 class="svelte-kv1s9f">Admin Dashboard</h1> <div class="user-info svelte-kv1s9f"><span class="svelte-kv1s9f"> </span> <button class="logout-btn svelte-kv1s9f">Logout</button></div></header> <main class="dashboard-content svelte-kv1s9f"><div class="article-form glass-panel svelte-kv1s9f"><h2 class="svelte-kv1s9f">Create New Article</h2> <!> <!> <form class="svelte-kv1s9f"><div class="form-group svelte-kv1s9f"><label for="title" class="svelte-kv1s9f">Title</label> <input type="text" id="title" required class="svelte-kv1s9f"></div> <div class="form-group svelte-kv1s9f"><label for="summary" class="svelte-kv1s9f">Summary</label> <textarea id="summary" rows="3" required class="svelte-kv1s9f"></textarea></div> <div class="form-group svelte-kv1s9f"><label for="article_text" class="svelte-kv1s9f">Article Content</label> <textarea id="article_text" rows="10" required class="svelte-kv1s9f"></textarea></div> <div class="form-group svelte-kv1s9f"><label for="image-upload" class="svelte-kv1s9f">Image Upload</label> <input type="file" id="image-upload" accept="image/*" required class="svelte-kv1s9f"> <!></div> <div class="form-row svelte-kv1s9f"><div class="form-group half svelte-kv1s9f"><label for="category" class="svelte-kv1s9f">Category</label> <select id="category" class="svelte-kv1s9f"><option class="svelte-kv1s9f">General</option><option class="svelte-kv1s9f">Political</option></select></div> <div class="form-group half checkbox-group svelte-kv1s9f"><label class="checkbox-label svelte-kv1s9f"><input type="checkbox" class="svelte-kv1s9f"> Featured Article</label></div></div> <button type="submit" class="submit-btn svelte-kv1s9f"> </button></form></div></main></div>');function sa(a,m){qe(m,!1);let n=_(null),d="",u=_(!0),c=_(""),b=_(""),k=_(""),D=_(""),S=null,w=_(""),I=_("General"),L=_(!1),f=_(!1),F=_("");Ee(()=>{d=localStorage.getItem("authToken");const o=localStorage.getItem("user");if(!d||!o){Z("/admin/login");return}try{t(n,JSON.parse(o)),t(u,!1)}catch(s){console.error("Error parsing user data:",s),localStorage.removeItem("authToken"),localStorage.removeItem("user"),Z("/admin/login")}});function ce(o){const s=o.target.files[0];if(!s){S=null,t(w,"");return}if(!s.type.match("image.*")){t(c,"Please select an image file"),o.target.value="";return}S=s;const g=new FileReader;g.onload=h=>{t(w,h.target.result)},g.readAsDataURL(s)}async function fe(o){if(o.preventDefault(),t(f,!0),t(F,""),t(c,""),!S){t(c,"Please select an image file"),t(f,!1);return}try{const s=new FormData;s.append("title",e(b)),s.append("summary",e(k)),s.append("article_text",e(D)),s.append("image",S),s.append("category",e(I)),s.append("featured",e(L)),s.append("date",new Date().toISOString());const g=await fetch(`${$e}/articles`,{method:"POST",headers:{Authorization:`Bearer ${d}`},body:s}),h=await g.json();if(!g.ok)throw new Error(h.message||h.error||"Failed to submit article");t(b,""),t(k,""),t(D,""),S=null,t(w,""),t(I,"General"),t(L,!1),document.getElementById("image-upload").value="",t(F,"Article successfully published!")}catch(s){t(c,s.message)}finally{t(f,!1)}}function me(){localStorage.removeItem("authToken"),localStorage.removeItem("user"),Z("/admin/login")}Pe();var ee=Ie();Te(o=>{Fe.title="Admin Dashboard - Political Gossips"});var pe=De(ee);{var _e=o=>{var s=Ne();x(o,s)},ge=o=>{var s=He(),g=r(s),h=v(r(g),2),T=r(h),be=r(T);l(T);var ke=v(T,2);l(h),l(g);var ae=v(g,2),te=r(ae),se=v(r(te),2);{var he=i=>{var p=je(),y=r(p),V=r(y,!0);l(y),l(p),P(()=>G(V,e(c))),x(i,p)};O(se,i=>{e(c)&&i(he)})}var re=v(se,2);{var ye=i=>{var p=Je(),y=r(p),V=r(y,!0);l(y),l(p),P(()=>G(V,e(F))),x(i,p)};O(re,i=>{e(F)&&i(ye)})}var $=v(re,2),B=r($),U=v(r(B),2);ne(U),l(B);var E=v(B,2),M=v(r(E),2);oe(M),l(E);var R=v(E,2),z=v(r(R),2);oe(z),l(R);var N=v(R,2),j=v(r(N),2),xe=v(j,2);{var Se=i=>{var p=We(),y=r(p);l(p),P(()=>Be(y,"src",e(w))),x(i,p)};O(xe,i=>{e(w)&&i(Se)})}l(N);var J=v(N,2),W=r(J),C=v(r(W),2);P(()=>{e(I),Ce(()=>{e(f)})});var H=r(C);H.value=H.__value="General";var le=v(H);le.value=le.__value="Political",l(C),l(W);var ie=v(W,2),ve=r(ie),K=r(ve);ne(K),Ge(),l(ve),l(ie),l(J);var Q=v(J,2),we=r(Q,!0);l(Q),l($),l(te),l(ae),l(s),P(()=>{G(be,`Welcome, ${e(n).username??""}`),U.disabled=e(f),M.disabled=e(f),z.disabled=e(f),j.disabled=e(f),C.disabled=e(f),K.disabled=e(f),Q.disabled=e(f),G(we,e(f)?"Publishing...":"Publish Article")}),X("click",ke,me),Y(U,()=>e(b),i=>t(b,i)),Y(M,()=>e(k),i=>t(k,i)),Y(z,()=>e(D),i=>t(D,i)),X("change",j,ce),Re(C,()=>e(I),i=>t(I,i)),Ue(K,()=>e(L),i=>t(L,i)),X("submit",$,fe),x(o,s)};O(pe,o=>{e(u)?o(_e):o(ge,!1)})}x(a,ee),Le()}export{sa as component};
